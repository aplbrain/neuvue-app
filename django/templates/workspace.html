{% extends "base.html" %}
{% load static %}

{% block content %}
<! Information Hidden Menu >


<div id="neuVue-sidemenu" class="sidemenu">
    <div id="neuVue-sidebar" class="sidebar">
        <div id="queue-button" class="sidebutton" >
            <a id = "sidebarActivate" class="fill-div" onclick="sidemenu_content()">
                <i class="glyphicon glyphicon-list"></i>
            </a>
        </div>   
    </div>
    <div id="neuVue-sidecontent" class="sidecontent">
        
        <! Instructions >
        <div id = "instruction-container" class ="sideContentBox" style="max-height:22%;">
            <div class="sideContentTitle">
                Instructions
            </div>
            <div class="sideContentInfo">
                <p>Here are some sample instructions for this Proofreading task. There are many things to know while proofreading. But some key ones are.</p>
                <p><b>1.</b> Look at the Nueron.</p>
                <p><b>2.</b> Have fun.</p>
            </div>
        </div>
        <! Task Queue >
        <div id = "queue-container" class = "sideContentBox" style="max-height:65%;">
            <div class="sideContentTitle">
                Task Queue
            </div>
            <div class="sideContentInfo" >
                <button class="taskButton complete" onclick="block_toggle()"><i class="glyphicon glyphicon-ok-circle"></i> Another Completed Proofreading Task</button>
                <div class="informationContainer" style="border: 1.5px solid var(--complete-color);">
                    <div class="taskNumber">
                        Task #3242121
                    </div> 
                    <div class="taskInfo">
                        <p>Here is information about a task you have completed. Good Job!</p>
                    </div>
                </div>

                <button class="taskButton complete" onclick="block_toggle()"><i class="glyphicon glyphicon-ok-circle"></i> Completed Proofreading Task</button>
                <div class="informationContainer" style="border: 1.5px solid var(--complete-color);">
                    <div class="taskNumber">
                        Task #{{task_num}}
                    </div> 
                    <div class="taskInfo">
                    <p>Here is information about another task you have completed. You are doing great!</p>
                    </div>
                </div>
                <button id="currentTask" class="taskButton current active" onclick="block_toggle()"><i class="glyphicon glyphicon-play-circle"></i> Current Proofreading Task</button>
                <div class="informationContainer" style="display: inline-block;">
                    <div class="taskNumber">
                        Task #3242123
                    </div> 
                    <div class="taskInfo">
                    <p>Here is some task info. This Proofreading task is very important.</p>
                    <p>Here is more information about this important task.</p>
                    <ul>
                        <li><b>Skeleton:</b> Info about the skeleton.</li>
                        <li><b>Render:</b> Info about the render.</li>
                        <li><b>Neuron Type:</b> Info about the neuron type.</li>
                        <li><b>Total Volume:</b> Info about the volume of the neuron.</li>
                    </ul>
                    </div>
                </div>
                <button class="taskButton" onclick="block_toggle()"><i class="glyphicon glyphicon-record"></i> Undone Proofreading Task</button>
                <div class="informationContainer" style="border: 1.5px solid var(--incomplete-color);">
                    <div class="taskNumber">
                        Task #3242124
                    </div> 
                    <div class="taskInfo">
                    <p>You have not completed this task, but it is very important. It is very important that this is done.</p>
                    </div>   
                </div>
                <button class="taskButton" onclick="block_toggle()"><i class="glyphicon glyphicon-record"></i> Another Undone Proofreading Task</button>
                <div class="informationContainer" style="border: 1.5px solid var(--incomplete-color);">
                    <div class="taskNumber">
                        Task #3242125
                    </div> 
                    <div class="taskInfo">
                    <p>You have not completed this task either. These are very important, please do them.</p>
                    </div> 
                </div>
        </div>
        
    </div>
</div> 

</div>

<div id="neuroglancer" class="leftFormatting">
    <div class="left">
        <div class="topBar" >
                <div class="textBin left">
                    Task ID # {{task_id}}
                </div>
                <div class="textBin mid">
                    Segmentation ID # {{seg_id}}
                </div>
                <div class="textBin right">
                    Connected to {{pcg_url}}
                </div>

        </div>
        {% if is_open %}
        <iframe src="{{ng_url}}"
                width="95%" 
                height="85%"
                class="neuroGlancer">
        </iframe>
        {% endif %}
            <form action="" method="post" class="bottomBar">
                {% csrf_token %}
                
                {% if is_open %}
                <button type="submit" class="button" name="restart">
                    Restart Task
                </button>
        
                <button type="submit" class="button submit" name="submit">
                    Submit Task
                </button>

                <button type="submit" class="button flag" name="flag" id="flag">
                    Flag Task
                </button>
                
                <!-- The Modal -->
                <div id="flagModal" class="modal" name="flagging">

                    <!-- Modal content -->
                    <div class="modal-header">
                    <h1> Flagging Task #{{task_id}} </h1>
                    <div class="modal-content">
                        <p> Please choose the reason for flagging this task: </p>
                        <div class='options'>
                            <select id="select-box" name="error" onchange=GetReason(value)>
                                <option id="choice1" value="Artifact in the data"> Artifact in the data </option>
                                <option id="choice2" value="Wrong location"> Wrong location for point annotation </option>
                                <option id="choice3" value="Data unable to load"> Data unable to load </option>
                                <option id="choice4" value="Other" > Other </option>
                            </select>
                        </div>
                        <div id="other" class= "other">
                            <label for="other-textbox">Other:*</label>
                            <br>
                            <textarea class="flag-box" id="other-textbox" maxlength="100" rows="3" cols="60" placeholder="Input reason"></textarea>
                            <small> *Limit: 100 characters </small>
                        </div>
                        <div class='footer'>
                            <button id="submit-error" name="submit-error" >Submit error </button>
                            <button id="close">Close </button>
                        </div>
                    </div>
                    </div>
                </div>              
                <button type="submit" class="button flag" name="stop">
                    Pause Task and Exit Workspace
                </button>
                {% else %}

                {%if tasks_available %}
                <button type="submit" class="button submit" name="start">
                    Start New  Task
                </button>

                {% else %}
                <button type="submit" class="button submit" name="start" disabled >
                    No Pending Tasks
                </button> 
                
                {% endif%}
                
                <button type="submit" class="button flag" name="stop">
                    Exit Workspace
                </button>
                {% endif %}

            </form>
    </div>
</div>
<script type="text/javascript" src="{% static "js/utils.js" %}"></script>
<script>
    openSideMenu();
    block_toggle();
    activeTaskStartUp();

    /* Patch to allow current active task button not need double click for first interaction */
    function activeTaskStartUp() {
        var currentTaskButton = document.getElementById("currentTask");
        currentTaskButton.classList.toggle("active");
        var panel = currentTaskButton.nextElementSibling;
        if (panel.style.display === "block") {
            panel.style.display = "none";
        } else {
            panel.style.display = "block";
        }
    }
</script>
{% endblock %}


