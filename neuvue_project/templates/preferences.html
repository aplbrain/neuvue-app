{% extends "base.html" %}
{% load static %}


{% block content %}
<div class="pref_main_container">

    <div class="navbar-text" style='font-size:1vw;'> Preferences 
        <div class="form-check form-switch">
            <input class="form-check-input" type="checkbox" id="configSwitch">
            <label class="form-check-label" for="configSwitch"></label>
        </div>
    </div>

    <hr class="dropdown-divider">
    <div class="row-container">
        <div class=navbar-text> 2D Segmentation Data Opacity </div>
        
        <input id="alphaSelected" type="range" class="form-range" data-slider-min="0" 
            data-slider-max="100" data-slider-step="1" value="{{ alphaSelected }}" />

        <div id="alphaSelectedDisplay"></div>
    </div>
    <hr class="dropdown-divider">
    <div class="row-container">
        <div> 3D Segmentation Data Opacity </div>
        
        <input id="alpha3D" type="range" class="form-range" data-slider-min="0" 
            data-slider-max="100" data-slider-step="1" value="{{alpha3D}}" />

        <div id="alpha3DDisplay">Test</div>
    </div>

    <hr class="dropdown-divider">

    <div class="row-container">
        <div> Panel Layout </div>
        <select name="layout" class="form-select" id="layoutSelect" >
            <option>xy-3d</option>
            <option>yz-3d</option>
            <option>xz-3d</option>
            <option>4panel</option>
            <option>3d</option>
        </select> 
    </div>

    <hr class="dropdown-divider">
    
    <div style="flex-direction:column;">
        <button id="saveConfig" type="button" class="btn btn-primary" style="width:10vw;">Save</button>
        <button id="saveConfig" type="button" class="btn btn-secondary" style="width:10vw;">Reset To Default</button>
    </div>
</div>

<script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
<script>
    function submitConfigForm() {
        var form = $('<form>').attr('action', '').attr('method', 'get').attr('class', 'bottomBar').attr('style', 'order: 0;')
        $('<input>').attr('type', 'hidden').attr('name', 'alphaSelected').attr('value', document.getElementById("alphaSelected").value / 100).appendTo(form);
        $('<input>').attr('type', 'hidden').attr('name', 'alpha3D').attr('value', document.getElementById("alpha3D").value / 100).appendTo(form);
        $('<input>').attr('type', 'hidden').attr('name', 'layout').attr('value', getLayout()).appendTo(form);
        $(document.body).append(form)
        $(form).submit();
    }
    $(document).ready(function() {
        const layout = "{{layout}}";
        
        // Display value on sliders
        $("#alphaSelectedDisplay").html($("#alphaSelected").value / 100);
        $("#alpha3DDisplay").html($("#alpha3D").value / 100);

        // Update value on sliders
        $("#alphaSelected").change(function( ){
            console.log($("#alphaSelected").value / 100)
            $("#alphaSelectedDisplay").html($("#alphaSelected").value / 100)
        });
        
        $("#alpha3D").change(function( ){
            $("#alpha3DDisplay").html($("#alpha3D").value / 100)
        });
    });

    $("#saveConfig").click(function () {
        submitConfigForm()
    });

</script>
{% endblock %}